from pgn import parse_chess

# Test
parse_chess("1. e4 e5 2. Nc3 Nc6 { C25 Vienna Game: Max Lange Defense } 3. Bc4 Nf6 (3... Bc5 4. Qg4 { Vienna Copycat Variation }) 4. d3 { Vienna Hybrid } 4... Na5 (4... Bc5) 5. Nge2 Nxc4 6. dxc4 Bc5 7. Qd3 { Vienna Open Variation } *",
            core_key="1 # Chapter 1: Max Lange")

parse_chess("1. e4 { [%eval 0.25] } 1... e5 { [%eval 0.31] } 2. Nc3 { [%eval 0.12] } 2... Nc6 { [%eval 0.17] } 3. Bc4 { [%eval 0.09] } 3... Nf6 { [%eval 0.0] } 4. d3 { [%eval 0.13] } 4... Bc5 { [%eval 0.13] } 5. f4 { [%eval 0.0] } 5... d6 { [%eval 0.05] } 6. Nf3 { [%eval 0.0] } 6... Bg4 { [%eval 0.13] } (6... h6 7. Na4 Bb6) (6... O-O 7. f5 Na5 8. Bg5 Nxc4 9. dxc4 Bb4) 7. Na4 { [%eval 0.0] } 7... Bxf3 { [%eval 0.5] } (7... Nd4 8. Nxc5 Bxf3 (8... dxc5 9. c3 Bxf3 10. gxf3 Nc6 11. Bb5 a6 12. Bxc6+ bxc6 13. fxe5 Nd7 14. Bf4 O-O) 9. gxf3 dxc5 10. c3 Nc6) (7... Bb6 8. h3 Bxf3 9. Qxf3 Nd4 10. Qf2 Ba5+ (10... Nxc2+ 11. Qxc2) 11. c3 b5 12. O-O bxc4 13. cxd4 exd4 (13... cxd3 14. fxe5 dxe5 15. dxe5) (13... exf4 14. e5 dxe5 15. dxe5 Nd7 16. Bxf4 O-O) 14. Qxd4 cxd3 15. e5 Nd7) (7... exf4) (7... Bb4+ 8. c3 Ba5 9. b4 Bb6 10. Nxb6 axb6 11. h3 Bxf3 12. Qxf3 exf4 13. Bxf4 Ne5 14. Bxe5 dxe5 15. O-O O-O 16. Qg3 Qd6 17. Rf5 b5 18. Bb3 Rae8 19. Raf1) 8. Qxf3 { [%eval -0.25] } 8... Nd4 { [%eval 0.61] } 9. Qd1 { [%eval 0.36] } 9... b5 { [%eval 0.85] } 10. Bxf7+ { [%eval 1.09] } 10... Kxf7 { [%eval 0.74] } 11. Nxc5 { [%eval 0.89] } 11... dxc5 { [%eval 1.12] } (11... exf4 12. Nb3 Ne6 13. a4 Qd7 14. axb5 Qxb5 15. Bd2) 12. fxe5 { [%eval 0.92] } 12... Nd7 { [%eval 1.15] } (12... Ne8 13. O-O+ Ke6 14. Qg4+ Ke7 15. Bg5+ Nf6 16. exf6+ Kd6 17. fxg7) 13. O-O+ { [%eval 1.41] } (13. c3 Ne6 14. O-O+ Ke7 (14... Ke8 { [%cal Gd3d4] } 15. d4 cxd4 16. cxd4 Nxe5 17. Be3 Ng6 18. d5 Ng5) (14... Kg8 15. d4 c4) 15. d4 Rf8 16. d5 Nxe5 17. Rxf8 Kxf8 18. Qh5) 13... Kg8 { [%eval 1.04] } (13... Ke6 14. Qg4+ Kxe5 (14... Ke7 15. Qxg7+ Ke6 16. Qf7+ Kxe5 17. Bf4#) 15. Bf4+ Kf6 16. Bd6+ Nf5 17. Qxf5#) (13... Ke7 14. Bg5+ Ke8 (14... Nf6 15. exf6+ Kd6 16. c3 Ne6 17. Bh4 Qd7 18. d4 (18. a4) 18... cxd4 19. cxd4) 15. Bxd8) (13... Ke8) 14. c3 { [%eval 0.87] } 14... Ne6 { [%eval 1.26] } 15. d4 { [%eval 1.6] } 15... h5 { [%eval 1.71] } (15... h6) (15... cxd4 16. cxd4) 16. d5 { [%eval 1.93] } 16... Nef8 { [%eval 1.78] } (16... Ng5 17. Rf5 Nh7 18. Qf3 Qh4 19. Bf4 Rf8 20. e6 Rxf5 21. exf5 Nb6 22. Bxc7 Ng5 23. Qf4 Qxf4 24. Bxf4 Ne4 25. d6 g5 26. Be5) 17. e6 Ne5 *",
            core_key="2 Vienna Hybrid: Main Line")
